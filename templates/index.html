<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pricing Model</title>
  <style>
    :root{
      --bg:#f6f5f5;
      --primary-2:#B90E0A; /* very dark red */
      --primary:#D21404; /* dark red */
      --dark:#9e1116; /* brighter */
      --muted:#e9e6e6;
      --card:#ffffff;
      --accent:#ffd6d6;
      --glass: rgba(255,255,255,0.85);
    }
    *{box-sizing:border-box}
    body{font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin:0; background:var(--bg); color:#14202b}

    /* Layout */
    .app{display:flex; min-height:100vh}
    .sidebar{width:220px; background:linear-gradient(180deg,var(--dark),var(--primary)); color:#fff; padding:28px 18px; position:relative; justify-content: center;text-align: center;}
    .brand{font-weight:700; font-size:18px; margin-bottom:18px}
    .logo{width:160px; height:auto; margin-bottom:18px}
    .side-btn{display:block; margin:10px 0; background:white; border:2px solid rgba(255,255,255,0.12); color:#9e1116; padding:5px 6px; border-radius:8px; text-decoration:none}
    .side-btn:hover{background:rgba(255,255,255,0.03)}

    .main{flex:1; padding:18px}
    header.topbar{display:flex; align-items:center; justify-content:space-between; gap:12px}
    .title{background:var(--card); padding:14px 18px; border-radius:10px; box-shadow:0 6px 14px rgba(0,0,0,0.06); display:flex; gap:14px; align-items:right}
    .title h1{margin:0; font-size:18px; color:var(--primary)}
    .title .meta{font-size:13px; color:#666}

    /* Card area */
    .card{margin-top:18px; background:var(--card); border-radius:10px; padding:18px; box-shadow:0 10px 20px rgba(15,10,10,0.03)}

    /* Tabs (rounded style like typical navigation) */
    .tabs{margin-top:6px}
    .tab-controls{display:flex; border-bottom:2px solid rgba(0,0,0,0.08)}
    .tab-controls label{cursor:pointer; padding:10px 20px; border-radius:12px 12px 0 0; font-weight:600; background:var(--muted); margin-right:4px; color:var(--primary);}
    .tab-controls label:hover{background:#f0dada}

    input[type=radio]{display:none}

    .tab-panels{margin-top:0; padding-top:14px}
    .panel{display:none}

    #tab1:checked ~ .tabs .tab-controls label[for="tab1"],
    #tab2:checked ~ .tabs .tab-controls label[for="tab2"]{
      background:linear-gradient(180deg,var(--primary-2),var(--primary));
      color:#fff;
      box-shadow:0 -2px 6px rgba(122,15,21,0.2);
    }

    #tab1:checked ~ .tabs .tab-panels .panel-1,
    #tab2:checked ~ .tabs .tab-panels .panel-2{display:block}

    /* Table mimic */
    .table{width:100%; border-collapse:collapse; margin-top:12px}
    .table thead th{background:linear-gradient(90deg, rgba(122,15,21,0.06), rgba(122,15,21,0.02)); color:var(--primary); text-align:left; padding:10px 12px; font-size:13px; border-bottom:2px solid rgba(0,0,0,0.04)}
    .table tbody td{padding:10px 12px; border-bottom:1px solid #efefef; font-size:14px}
    .pill{display:inline-block; padding:6px 10px; border-radius:999px; font-weight:700; font-size:12px; background:var(--accent); color:var(--dark)}

    .controls{display:flex; gap:10px; align-items:center}
    .my-btn{border:var(--primary) solid 2px; color: var(--primary); padding:5px 6px; border-radius:12px; font-weight:bold; text-decoration:none; font-size: 11pt;}
    .my-btn:hover{background: var(--primary);color: white;cursor: pointer;}
    .btn.ghost{background:transparent; color:var(--primary); border:2px solid var(--primary)}

    /* small helpers */
    .flex{display:flex; align-items:center; gap:12px}
    .muted{color:#708090}
    .search{padding:8px 10px; border-radius:8px; border:1px solid #ddd}
    .file-display {margin-top: 14px;display: flex;flex-wrap: wrap;gap: 8px;}
    .file-pill {background: var(--accent);color: var(--dark);padding: 6px 12px;border-radius: 999px;font-size: 13px;font-weight: 600;box-shadow: 0 2px 4px rgba(0,0,0,0.06);}
    
    #tenor::placeholder, #asset-amount::placeholder {
        color: var(--primary-2);
        opacity: 1; 
        font-weight: bold; 
    }
    
    @media (max-width:900px){.sidebar{display:none}.main{padding:12px}}
  </style>
  <!-- Bootstrap Icons CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <!-- Logo placeholder -->
      <img src="logo-placeholder.png" alt="Company Logo" class="logo" />
      <div class="brand">PRICING MODEL</div>

      <div style="position:absolute; bottom:20px; left:18px; right:18px; font-size:12px; color:rgba(255,255,255,0.8)">
        <div style="font-size:11px; opacity:0.9">23 SEPTEMBER 2025</div>
      </div>
    </aside>

    <main class="main">
        <header class="topbar">
            <!-- <div class="title">
            <div style="width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--primary-2),var(--primary)); display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800">PM</div>
            <div>
                <h1>Pricing Model</h1>
                <div class="meta">System for model experiments & pricing reports</div>
            </div>
            </div> -->

            <!-- <div class="title">
            <div class="muted">Profile: <strong>ADMIN</strong></div>
            <a class="btn ghost" href="#">Logout</a>
            </div> -->
        </header>

        <section class="card">
            <!-- purely CSS tabs using radio inputs -->
            <input id="tab1" type="radio" name="tabs" checked>
            <input id="tab2" type="radio" name="tabs">

            <div class="tabs">
            <div class="tab-controls">
                <label for="tab1">FUND TRANSFER PRICING (FTP) MODEL <i class="bi bi-calculator-fill"></i></label>
                <label for="tab2">ASSET PRICING & FTP CHARGE SCHEDULE TOOL <i class="bi bi-tags-fill"></i></label>
            </div>

            <div class="tab-panels">
                <div class="panel panel-1">
                    <div class="flex" style="justify-content:space-between">
                        <div class="controls">
                            <a href="javascript:void(0)" class="my-btn" onclick="document.getElementById('fileInput').click();">Upload Required File</a>
                            <input type="file" id="fileInput" style="display: none;" />

                            <a class="my-btn" data-bs-toggle="modal" data-bs-target="#yieldCurvesModal">
                                Yield Curves
                            </a>
                            <a class="my-btn">Export Workbook</a>
                        </div>
                    </div>
                    <div id="fileNameDisplay" class="file-display"></div>


                    <div class="parameter-inputs" style="margin: 2rem 0; padding:20px; background:var(--card); border-radius:12px; max-width:100%; box-shadow:0 6px 15px rgba(0,0,0,0.05); border:1px solid rgba(0,0,0,0.08);">

                        <h3 style="margin:0 0 12px 0; font-size:1rem; font-weight:700; color:var(--primary); border-bottom:1px solid rgba(0,0,0,0.1); padding-bottom:6px;">
                            TREASURY PARAMETERS
                        </h3>

                        <!-- Cards Row -->
                        <div style="display:flex; flex-direction:row; gap:1rem; justify-content:flex-start;">

                            <!-- Treasury Minimum Balance -->
                            <div style="display:flex; align-items:center; justify-content:space-between;
                                        background: linear-gradient(135deg, var(--primary-2), var(--primary));
                                        padding:6px 7px; border-radius:10px; color:#fff; box-shadow:0 4px 10px rgba(0,0,0,0.15); width:max-content;">
                                        
                            <label for="min-balance" style="font-weight:600; letter-spacing:0.3px; font-size:0.85rem;">
                                MINIMUM OPERATING BALANCE:
                            </label>

                            <div style="display:flex; align-items:center; gap:6px; margin-left:10px;">
                                <input type="number" id="min-balance" name="min-balance" placeholder="0" step="0.01" min="0" max="100"
                                    style="padding:6px 8px; border:none; border-radius:6px; width:80px; text-align:center; font-weight:600; font-size: small; color:var(--primary-2); background:#fff;">
                                <span style="font-weight:700; color:#fff;">%</span>
                            </div>
                            </div>

                            <!-- Cash Average -->
                            <div style="display:flex; align-items:center;
                                        background: linear-gradient(135deg, var(--primary-2), var(--primary));
                                        padding:6px 7px; border-radius:10px; color:#fff; box-shadow:0 4px 10px rgba(0,0,0,0.15); width:max-content;">

                                <label for="cash-avg" style="font-weight:600; letter-spacing:0.3px; font-size:0.85rem;">
                                    FX CASH, NOSTRO, RTGS MONTH'S AVERAGE:
                                </label>

                                <div style="display:flex; align-items:center; gap:6px; margin-left:10px;">
                                    <input type="number" id="cash-avg" name="cash-avg" placeholder="0" step="0.01" min="0" max="100"
                                        style="padding:6px 8px; border:none; border-radius:6px; width:80px; text-align:center; font-weight:600; color:var(--primary-2); background:#fff;">
                                    <span style="font-weight:700; color:#fff;">%</span>
                                </div>
                            </div>

                            <div style="display:flex; align-items:center;
                                        background: linear-gradient(135deg, var(--primary-2), var(--primary));
                                        padding:6px 7px; border-radius:10px; color:#fff; box-shadow:0 4px 10px rgba(0,0,0,0.15); width:max-content;">

                                <label for="cash-avg-zwg" style="font-weight:600; letter-spacing:0.3px; font-size:0.85rem;">
                                    ZWG CASH, RTGS MONTH'S AVERAGE:
                                </label>

                                <div style="display:flex; align-items:center; gap:6px; margin-left:10px;">
                                    <input type="number" id="cash-avg-zwg" name="cash-avg-zwg" placeholder="0" step="0.01" min="0" max="100"
                                        style="padding:6px 8px; border:none; border-radius:6px; width:80px; text-align:center; font-weight:600; color:var(--primary-2); background:#fff;">
                                    <span style="font-weight:700; color:#fff;">%</span>
                                </div>
                            </div>

                            <div style="display: flex;">  
                                <a class="btn" href="#">Apply</a>
                            </div>
                        </div>

                    </div>

                    <div class="modal fade" id="yieldCurvesModal" tabindex="-1" aria-labelledby="yieldCurvesModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-xl modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="yieldCurvesModalLabel">FTP YIELD CURVES</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">

                                    <h4 style="margin:0 0 12px 0; font-size:1rem; font-weight:700; color:var(--primary); border-bottom:1px solid rgba(0,0,0,0.1)">ZWG FTP Yield Curve</h4>
                                    <div class="table-responsive mb-5">
                                        {{ zwg_table | safe }}
                                    </div>

                                    <h4 style="margin:0 0 12px 0; font-size:1rem; font-weight:700; color:var(--primary); border-bottom:1px solid rgba(0,0,0,0.1)">USD FTP Yield Curve</h4>
                                    <div class="table-responsive">
                                        {{ usd_table | safe }}
                                    </div>

                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="my-btn">Save Changes</button>
                                    <button type="button" class="my-btn" data-bs-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section below parameter inputs -->
                    <div style="margin: 2rem 0; padding:20px; background:var(--card); border-radius:12px; max-width:100%; 
                                box-shadow:0 6px 15px rgba(0,0,0,0.05); border:1px solid rgba(0,0,0,0.08); display:flex;">

                        <!-- Left Column -->
                        <div style="flex:1; padding-right:16px; border-right:1px solid rgba(0,0,0,0.08);">
                            <h4 style="margin-top:0; font-weight:700; color:var(--primary); font-size:0.95rem;">ZWG FTP</h4>
                            <p style="font-size:0.85rem; color:#14202b; margin:6px 0 0 0;">
                            Content for the left side. You can add tables, charts, or any controls here.
                            </p>
                        </div>

                        <!-- Right Column -->
                        <div style="flex:1; padding-left:16px;">
                            <h4 style="margin-top:0; font-weight:700; color:var(--primary); font-size:0.95rem;">USD FTP</h4>
                            <p style="font-size:0.85rem; color:#14202b; margin:6px 0 0 0;">
                            Content for the right side. This column mirrors the left with consistent spacing and theme.
                            </p>
                        </div>

                    </div>


                </div>

                <div class="panel panel-2" 
                    style="padding:20px; max-width:450px; background:var(--card); border-radius:16px; box-shadow:0 6px 14px rgba(0,0,0,0.06);">

                    <!-- Flask Form -->
                    <form id="assetForm">

                        <!-- Currency Dropdown -->
                        <div style="margin-bottom:15px;">
                            <label for="currency" style="font-weight:bold; display:block; margin-bottom:5px; color:var(--primary)">
                                Asset Currency
                            </label>
                            <select name="currency" id="currency" class="search"
                                    style="width:100%; border:2px solid var(--primary); border-radius:12px; padding:6px 10px;
                                        color:var(--primary-2); font-weight: bold;font-size: 12px;" required>
                                <option value="" disabled selected>Select Currency</option>
                                <option value="USD">USD</option>
                                <option value="ZWG">ZWG</option>
                            </select>
                        </div>

                        <!-- Tenor Number Input -->
                        <div style="margin-bottom:15px;">
                            <label for="tenor" style="font-weight:bold; display:block; margin-bottom:5px; color:var(--primary)">
                                Tenor (Months)
                            </label>
                            <input name="tenor" id="tenor" type="number" min="1" max="360" step="1"
                                placeholder="Enter tenor in months" class="search"
                                style="width:100%; border:2px solid var(--primary); border-radius:12px; padding:6px 10px;
                                        color:var(--primary-2); font-weight: bold;font-size: 12px;" required>
                        </div>

                        <!-- Source of Funding Dropdown -->
                        <div style="margin-bottom:20px;">
                            <label for="source" style="font-weight:bold; display:block; margin-bottom:5px; color:var(--primary)">
                                Source of Funding
                            </label>
                            <select name="source" id="source" class="search"
                                    style="width:100%; border:2px solid var(--primary); border-radius:12px; padding:6px 10px;
                                        color:var(--primary-2); font-weight: bold;font-size: 12px;" required>
                                <option value="" disabled selected>Select Source</option>
                                <option value="Line Of Credit">Line Of Credit</option>
                                <option value="Demand Deposits">Demand Deposits</option>
                                <option value="Treasury Deposits">Treasury Deposits</option>
                            </select>
                        </div>

                        <!-- Apply Button -->
                        <div class="flex" style="justify-content:center; margin-top:10px;">

                            <button type="submit" class="my-btn" style="padding: 4px 25px; font-size:13px;">Apply</button>
                        </div>



                    </form>

                    <!-- Result Section -->
                    <div id="result"
                        style="margin-top:20px; padding:12px; background-color:var(--accent); border-radius:12px; 
                                font-weight:bold; text-align:center; color:var(--dark); 
                                box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);">
                        Result will appear here
                    </div>

                    <div class="card">
                        <div class="flex">
                            <label for="ftp-option" style="font-weight:bold; color:var(--primary);">
                            Generate Asset FTP Charge Schedule?
                            </label>
                            <select name="ftp-option" id="ftp-option" class="search"
                                    style="border:2px solid var(--primary); border-radius:12px; padding:6px 10px;
                                        color:var(--primary-2); font-weight: bold;font-size: 12px;" required>
                            <option value="no">No</option>
                            <option value="yes">Yes</option>
                            </select>
                        </div>

                        <!-- Hidden section -->
                        <div class="flex" id="ftp-schedule-section" style="margin-top:16px; display:none; flex-direction:column; gap:10px;">

                            <!-- Disbursement Amount -->
                            <div class="flex" style="gap:10px; align-items:center;">
                                <label for="asset-amount" style="font-weight:bold; color:var(--primary); min-width:180px;">
                                    Disbursement Amount
                                </label>
                                <input type="number" id="asset-amount" class="search" placeholder="Enter amount" style="max-width: 180px;font-size: 12px;color:var(--primary-2);font-weight: bold;">
                            </div>
                            <br>

                            <!-- Disbursement Date -->
                            <div class="flex" style="gap:10px; align-items:center;">
                                <label for="asset-date" style="font-weight:bold; color:var(--primary); min-width:180px;">
                                    Disbursement Date
                                </label>
                                <input type="date" id="asset-date" class="search" style="font-size: 13px;color:var(--primary-2);font-weight: bold;">
                            </div>
                            <br>

                            <!-- Repayment Type -->
                            <div class="flex" style="gap:10px; align-items:center;">
                                <label for="repayment-type" style="font-weight:bold; color:var(--primary); min-width:180px;">
                                    Repayment Type
                                </label>
                                <select name="repayment-type" id="repayment-type" class="search"
                                        style="width:100%; border:2px solid var(--primary); border-radius:12px; padding:6px 10px;
                                            color:var(--primary-2); font-weight: bold;font-size: 12px;" required>

                                    <option value="" disabled selected>Select type</option>
                                    <option value="bullet">Bullet</option>
                                    <option value="amortising">Amortising</option>
                                </select>
                            </div>

                            <!-- Generate Schedule Button -->
                            <div class="flex" style="justify-content:center; margin-top:10px;">
                                <button class="my-btn">Generate Schedule</button>
                            </div>
                        </div>


                    </div>

                </div>



            </div>

        </section>

    </main>
  </div>
<script>
    // Make all table cells editable
    document.querySelectorAll('.table-responsive table td, .table-responsive table th')
        .forEach(cell => {
            cell.setAttribute('contenteditable', 'true');
        });
</script>
<script>
  document.getElementById("fileInput").addEventListener("change", function () {
    let output = document.getElementById("fileNameDisplay");
    output.innerHTML = ""; // clear previous
    
    if (this.files.length > 0) {
      for (let i = 0; i < this.files.length; i++) {
        let file = this.files[i];
        
        let div = document.createElement("div");
        div.className = "file-pill";
        div.textContent = file.name;
        
        output.appendChild(div);
      }
    }
  });
</script>
<script>
  const ftpOption = document.getElementById("ftp-option");
  const ftpSection = document.getElementById("ftp-schedule-section");

  ftpOption.addEventListener("change", function() {
    if (this.value === "yes") {
      ftpSection.style.display = "block";
    } else {
      ftpSection.style.display = "none";
    }
  });
</script>
<script>
document.getElementById("assetForm").addEventListener("submit", function(event) {
  event.preventDefault(); // prevent page reload

  // Get input values
  const currency = document.getElementById("currency").value;
  const tenor = parseInt(document.getElementById("tenor").value); // in months
  const source = document.getElementById("source").value;

  // Decide which table
  let tableId = null;
  if (currency === "USD") {
    tableId = "usdTable";
  } else if (currency === "ZWG") {
    tableId = "zwgTable";
  }

  if (!tableId) {
    alert("No table available for selected currency");
    return;
  }

  const table = document.getElementById(tableId);

  // Lookup row based on source of funding
    let lookupRowName = null;

    if (source.toLowerCase() === "line of credit" || source.toLowerCase() === "lines of credit") {
        lookupRowName = "Lines of Credit Curve Offer Rate";
    } else if (source.toLowerCase() === "demand deposits") {
        lookupRowName = "Normal Curve Offer Rate"; // replace with actual row name in your table
    } else if (source.toLowerCase() === "treasury deposits") {
        lookupRowName = "Treasury Curve Offer Rate"; // replace with actual row name in your table
    } else {
        alert("Lookup not defined for this source");
        return;
    }

  let targetRow = null;
  // Skip the header row (index 0)
  for (let i = 1; i < table.rows.length; i++) {
    const row = table.rows[i];
    if (row.cells[0].innerText.trim() === lookupRowName) {
      targetRow = row;
      break;
    }
  }

  if (!targetRow) {
    alert("Row not found in table");
    return;
  }

    // Find the column that matches the tenor
    const headerRow = table.rows[0]; // table header
    let targetValue = null;

    for (let j = 1; j < headerRow.cells.length; j++) {
    const colName = headerRow.cells[j].innerText.trim();

    let min = 0, max = Infinity;

    let match = null;

    // Check for year range first (important for tenors >= 12 months)
    match = colName.match(/^(\d+)y-(\d+)y$/);
    if (match) {
        min = parseInt(match[1], 10) * 12; // convert years to months
        max = parseInt(match[2], 10) * 12;
    } else if (colName.includes('>5y')) {
        min = 60; // 5 years in months
        max = Infinity;
    } else {
        // Check for month range
        match = colName.match(/^(\d+)m-(\d+)m$/);
        if (match) {
            min = parseInt(match[1], 10);
            max = parseInt(match[2], 10);
        } else {
            // Column doesn't match any expected pattern, skip
            continue;
        }
    }

    // Now compare tenor (make sure it's a number) with min/max
    const tenorMonths = parseInt(tenor, 10);
    if (tenorMonths >= min && tenorMonths < max) {
        targetValue = targetRow.cells[j].innerText.trim();
        break;
    }
    }

  if (targetValue) {
    document.getElementById("result").textContent = `Offer rate before Admin & other costs: ${targetValue} %`;
  } else {
    document.getElementById("result").textContent = "No matching column found for given tenor";
  }
});
</script>

</body>
</html>
